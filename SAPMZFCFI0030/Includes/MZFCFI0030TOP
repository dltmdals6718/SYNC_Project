*&---------------------------------------------------------------------*
*& Include MZFCFI0030TOP                            - Module Pool      SAPMZFCFI0030
*&---------------------------------------------------------------------*
PROGRAM SAPMZFCFI0030.

TABLES:
  ZSFC_FI_0160, " AP 반제 방식 및 입력 정보
  ZSFC_FI_0170, " AP 전표 조회 조건
  ZSFC_FI_0100, " 전표 헤더 정보
  ZTFC_MMT020,  " 공급업체 정보
  ZSFC_FI_0180, " AP 조회 결과 정보
  ZSFC_MM_0060, " 송장 헤더 정보
  ZSFC_FI_0060. " 사원 정보


* 미결 항목 조회 데이터 타입
TYPES: BEGIN OF TS_OPEN_ITEM.
         INCLUDE TYPE ZSFC_FI_0150.
TYPES:   LIGHT TYPE C LENGTH 1.
TYPES: END OF TS_OPEN_ITEM.

DATA: OK_CODE TYPE SY-UCOMM.

* 지급 Dialog 서브스크린
DATA: GV_DYNNR TYPE SY-DYNNR.

* 미결 항목, 반제 이력, 전표 아이템, 반제 전표 아이템, 송장 아이템 조회 ALV
DATA: GO_OPEN_ITEM_CONTAINER         TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_OPEN_ITEM_ALV_GRID          TYPE REF TO CL_GUI_ALV_GRID,
      GO_OPEN_ITEM_HISTORY_CONTAINER TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_OPEN_ITEM_HISTORY_ALV_GRID  TYPE REF TO CL_GUI_ALV_GRID,
      GO_ITEM_CONTAINER              TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ITEM_ALV_GRID               TYPE REF TO CL_GUI_ALV_GRID,
      GO_CLEARING_CONTAINER          TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_CLEARING_ALV_GRID           TYPE REF TO CL_GUI_ALV_GRID,
      GO_INVOICE_ITEM_CONTAINER      TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_INVOICE_ITEM_ALV_GRID       TYPE REF TO CL_GUI_ALV_GRID.

* 미결 항목, 이력, 미결 항목 아이템, 반제전표 아이템, 송장 아이템 ALV FCAT, Layout
DATA: GT_OPEN_ITEM_FCAT           TYPE LVC_T_FCAT,
      GS_OPEN_ITEM_LAYOUT         TYPE LVC_S_LAYO,
      GT_OPEN_ITEM_HISTORY_FCAT   TYPE LVC_T_FCAT,
      GS_OPEN_ITEM_HISTORY_LAYOUT TYPE LVC_S_LAYO,
      GT_ITEM_FCAT                TYPE LVC_T_FCAT,
      GS_ITEM_LAYOUT              TYPE LVC_S_LAYO,
      GT_CLEARING_ITEM_FCAT       TYPE LVC_T_FCAT,
      GS_CLEARING_ITEM_LAYOUT     TYPE LVC_S_LAYO,
      GT_INVOICE_ITEM_FCAT        TYPE LVC_T_FCAT,
      GS_INVOICE_ITEM_LAYOUT      TYPE LVC_S_LAYO.

* 조회 - 미결 항목 조회
DATA: GT_OPEN_ITEM TYPE TABLE OF TS_OPEN_ITEM,
      GS_OPEN_ITEM LIKE LINE OF GT_OPEN_ITEM.

* 조회 - 미결항목 전표 아이템, 반제 전표 아이템, 송장 아이템
DATA: GT_ITEM_DATA          TYPE TABLE OF ZSFC_FI_0110,
      GS_ITEM_DATA          LIKE LINE OF GT_ITEM_DATA,
      GT_CLEARING_ITEM_DATA TYPE TABLE OF ZSFC_FI_0110,
      GS_CLEARING_ITEM_DATA LIKE LINE OF GT_CLEARING_ITEM_DATA,
      GT_INVOICE_ITEM_DATA  TYPE TABLE OF ZTFC_FIT080.

* 조회 - 반제 이력
DATA: GT_OPEN_ITEM_HISTORY TYPE TABLE OF ZSFC_FI_0210,
      GS_OPEN_ITEM_HISTORY LIKE LINE OF GT_OPEN_ITEM_HISTORY.

* 생성 - 공급업체 지급 전표 헤더, 아이템
DATA: GS_DOCUMENT_HEAER TYPE ZTFC_FIT020,
      GT_DOCUMENT_ITEM  TYPE TABLE OF ZTFC_FIT030,
      GS_DOCUMENT_ITEM  LIKE LINE OF GT_DOCUMENT_ITEM.
