*&---------------------------------------------------------------------*
*& Include          MZFCFI0010C01
*&---------------------------------------------------------------------*

CLASS LCL_EVENT_HANDLER DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS:
      ON_HOTSPOT_CLICK FOR EVENT HOTSPOT_CLICK
        OF CL_GUI_ALV_GRID
        IMPORTING ES_ROW_NO E_COLUMN_ID,

      ON_TOOLBAR FOR EVENT TOOLBAR
        OF CL_GUI_ALV_GRID
        IMPORTING E_OBJECT,

      ON_USER_COMMAND FOR EVENT USER_COMMAND
        OF CL_GUI_ALV_GRID
        IMPORTING E_UCOMM.
ENDCLASS.

CLASS LCL_EVENT_HANDLER IMPLEMENTATION.
  METHOD ON_HOTSPOT_CLICK.

    READ TABLE GT_HEADER_DATA INTO GS_HEADER_DATA INDEX ES_ROW_NO-ROW_ID.

    CASE E_COLUMN_ID-FIELDNAME.
      WHEN 'PERNR'.
        CALL SCREEN 140
          STARTING AT 5 5.
    ENDCASE.


  ENDMETHOD.

  METHOD ON_TOOLBAR.
    DATA: LS_BUTTON TYPE STB_BUTTON.

    LS_BUTTON-BUTN_TYPE = 3.
    APPEND LS_BUTTON TO E_OBJECT->MT_TOOLBAR.

    CLEAR LS_BUTTON.
    LS_BUTTON-FUNCTION = 'DETAIL'.
    LS_BUTTON-BUTN_TYPE = 0.
    LS_BUTTON-ICON = ICON_DETAIL.
    LS_BUTTON-TEXT = ' 상세보기'.
    LS_BUTTON-QUICKINFO = '전표 아이템을 봅니다.'.
    LS_BUTTON-CHECKED = SPACE.
    APPEND LS_BUTTON TO E_OBJECT->MT_TOOLBAR.

    CLEAR LS_BUTTON.
    LS_BUTTON-FUNCTION = 'APPROVE'.
    LS_BUTTON-BUTN_TYPE = 0.
    LS_BUTTON-ICON = ICON_CHECKED.
    LS_BUTTON-TEXT = ' 승인'.
    LS_BUTTON-CHECKED = SPACE.
    LS_BUTTON-QUICKINFO = '전표를 승인합니다.'.
    APPEND LS_BUTTON TO E_OBJECT->MT_TOOLBAR.

    CLEAR LS_BUTTON.
    LS_BUTTON-FUNCTION = 'REJECT'.
    LS_BUTTON-BUTN_TYPE = 0.
    LS_BUTTON-ICON = ICON_INCOMPLETE.
    LS_BUTTON-TEXT = ' 반려'.
    LS_BUTTON-QUICKINFO = '전표를 반려합니다.'.
    APPEND LS_BUTTON TO E_OBJECT->MT_TOOLBAR.

  ENDMETHOD.

  METHOD ON_USER_COMMAND.
    CASE E_UCOMM.
      WHEN 'APPROVE'.
        PERFORM APPROVE_SELECTED_HEADERDS.
      WHEN 'REJECT'.
        PERFORM REJECT_SELECTED_HEADER.
      WHEN 'DETAIL'.
        PERFORM DETAIL_SELECTED_HEADER.
    ENDCASE.
  ENDMETHOD.

ENDCLASS.

CLASS LCL_ITEM_SEARCH_EVENT_HANDLER DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS:
      ON_HOTSPOT_CLICK FOR EVENT HOTSPOT_CLICK
        OF CL_GUI_ALV_GRID
        IMPORTING ES_ROW_NO E_COLUMN_ID.
ENDCLASS.

CLASS LCL_ITEM_SEARCH_EVENT_HANDLER IMPLEMENTATION.
  METHOD ON_HOTSPOT_CLICK.

    READ TABLE GT_ITEM_DATA INTO GS_ITEM_DATA INDEX ES_ROW_NO-ROW_ID.

    CASE E_COLUMN_ID-FIELDNAME.
      WHEN 'KUNNR'.
        CALL SCREEN 120
          STARTING AT 5 5.
      WHEN 'LIFNR'.
        CALL SCREEN 130
          STARTING AT 5 5.
    ENDCASE.
  ENDMETHOD.
ENDCLASS.

CLASS LCL_ITEM_CREATE_EVENT_HANDLER DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS:
      ON_TOOLBAR FOR EVENT TOOLBAR
        OF CL_GUI_ALV_GRID
        IMPORTING E_OBJECT,

      ON_USER_COMMAND FOR EVENT USER_COMMAND
        OF CL_GUI_ALV_GRID
        IMPORTING E_UCOMM.
ENDCLASS.

CLASS LCL_ITEM_CREATE_EVENT_HANDLER IMPLEMENTATION.
  METHOD ON_TOOLBAR.

    DATA: LS_BUTTON TYPE STB_BUTTON.

    LS_BUTTON-BUTN_TYPE = 3.
    APPEND LS_BUTTON TO E_OBJECT->MT_TOOLBAR.

    CLEAR LS_BUTTON.
    LS_BUTTON-FUNCTION = 'ITEM_DEL'.
    LS_BUTTON-TEXT = ' 삭제'.
    LS_BUTTON-ICON = ICON_DELETE_ROW.
    APPEND LS_BUTTON TO E_OBJECT->MT_TOOLBAR.

  ENDMETHOD.

  METHOD ON_USER_COMMAND.
    CASE E_UCOMM.
      WHEN 'ITEM_DEL'.
        PERFORM DEL_SELECTED_ITEMS.
    ENDCASE.
  ENDMETHOD.
ENDCLASS.
