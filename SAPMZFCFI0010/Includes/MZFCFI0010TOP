*&---------------------------------------------------------------------*
*& Include MZFCFI0010TOP                            - Module Pool      SAPMZFCFI0010
*&---------------------------------------------------------------------*
PROGRAM SAPMZFCFI0010.

TABLES: ZTFC_FIT020,
        ZTFC_MMT020, " 공급업체 정보 조회
        ZSFC_FI_0060, " 사원 정보
        ZSFC_FI_0120, " 고객 정보
        ZSFC_FI_0010,
        ZSFC_FI_0020,
        ZSFC_FI_0030.

DATA: OK_CODE TYPE SY-UCOMM.

* 조회 - 전표 헤더, 전표상태 집계, 아이템의 데이터 타입
TYPES: BEGIN OF TS_HEADER_DATA.
         INCLUDE TYPE ZTFC_FIT020.
TYPES:   LIGHT   TYPE C LENGTH 1,
         PERNAME TYPE ZTFC_SDT040-PERNAME.
TYPES: END OF TS_HEADER_DATA.

TYPES: BEGIN OF TS_HEADER_STATUS_DATA.
TYPES: ALL_CNT     TYPE I,
       UNAPPROVE   TYPE I,
       APPROVE_CNT TYPE I,
       REJECT_CNT  TYPE I.
TYPES: END OF TS_HEADER_STATUS_DATA.

TYPES: BEGIN OF TS_ITEM_DATA.
         INCLUDE TYPE ZTFC_FIT030.
TYPES:   DEBIT  TYPE ZSFC_FI_0020-DEBIT,
         CREDIT TYPE ZSFC_FI_0020-CREDIT,
         GLTXT  TYPE ZSFC_FI_0020-GLTXT.
TYPES: END OF TS_ITEM_DATA.

* 변경 - 전표 아이템 데이터 타입.
TYPES: BEGIN OF TS_ITEM_UPDATE_DATA.
         INCLUDE TYPE ZTFC_FIT030.
TYPES:   DEBIT    TYPE ZSFC_FI_0020-DEBIT,
         CREDIT   TYPE ZSFC_FI_0020-CREDIT,
         GLTXT    TYPE ZSFC_FI_0020-GLTXT,
         CELLSTYL TYPE LVC_T_STYL.
TYPES: END OF TS_ITEM_UPDATE_DATA.

* 조회 - 전표 헤더, 상태 집계, 아이템, 반려시 아이템 선언
DATA: GT_HEADER_DATA        TYPE TABLE OF TS_HEADER_DATA WITH KEY BELNR,
      GS_HEADER_DATA        LIKE LINE OF GT_HEADER_DATA,
      GS_HEADER_STATUS_DATA TYPE TS_HEADER_STATUS_DATA,
      GT_ITEM_DATA          TYPE TABLE OF TS_ITEM_DATA,
      GS_ITEM_DATA          LIKE LINE OF GT_ITEM_DATA,
      GT_REJECT_ITEM_DATA   TYPE TABLE OF ZSFC_FI_0110,
      GS_REJECT_ITEM_DATA   LIKE LINE OF GT_REJECT_ITEM_DATA.

* 전표 헤더, 아이템, 아이템 생성, 반려 아이템 Field Catalog.
DATA: GT_HEADER_FCAT      TYPE LVC_T_FCAT,
      GT_ITEM_FCAT        TYPE LVC_T_FCAT,
      GT_ITEM_CREATE_FCAT TYPE LVC_T_FCAT,
      GT_ITEM_UPDATE_FCAT TYPE LVC_T_FCAT,
      GT_REJECT_ITEM_FCAT TYPE LVC_T_FCAT.

* 조회 - 전표 헤더, 아이템, 반려 아이템 Layout Structure
DATA: GS_HEADER_LAYOUT      TYPE LVC_S_LAYO,
      GS_ITEM_LAYOUT        TYPE LVC_S_LAYO,
      GS_REJECT_ITEM_LAYOUT TYPE LVC_S_LAYO.

* 조회 - ALV Grid Data Sort
DATA: GT_HEADER_SORT TYPE LVC_T_SORT.

* 조회 - 전표 헤더, 아이템, 반려 아이템 ALV
DATA: GO_HEADER_CONTAINER      TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_HEADER_ALV_GRID       TYPE REF TO CL_GUI_ALV_GRID,
      GO_ITEM_CONTAINER        TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ITEM_ALV_GRID         TYPE REF TO CL_GUI_ALV_GRID,
      GO_REJECT_ITEM_CONTAINER TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_REJECT_ITEM_ALV_GRID  TYPE REF TO CL_GUI_ALV_GRID.

* 생성 - 전표 헤더 타입
DATA: GS_HEADER_DATA_CREATE TYPE ZTFC_FIT020.

* 생성 - 전표 아이템 변수 선언, ALV List Data, DB에 Insert때  쓰임
DATA: GT_ITEM_CREATE_DATA TYPE TABLE OF TS_ITEM_DATA,
      GS_ITEM_CREATE_DATA LIKE LINE OF GT_ITEM_CREATE_DATA.

* 생성 - 전표 아이템 ALV
DATA: GO_ITEM_CREATE_CONTAINER TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ITEM_CREATE_ALV_GRID  TYPE REF TO CL_GUI_ALV_GRID.

* 생성 - 전표 아이템 Layout Structure
DATA: GS_ITEM_CREATE_LAYOUT TYPE LVC_S_LAYO.

* 변경 - 전표 아이템 ALV
DATA: GO_ITEM_UPDATE_CONTAINER TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ITEM_UPDATE_ALV_GRID  TYPE REF TO CL_GUI_ALV_GRID.

* 변경 - 전표 아이템 Layout Structure
DATA: GS_ITEM_UPDATE_LAYOUT TYPE LVC_S_LAYO.

* 변경 - 전표 아이템
DATA: GT_ITEM_UPDATE_DATA TYPE TABLE OF TS_ITEM_UPDATE_DATA WITH KEY BELNR BUZEI,
      GS_ITEM_UPDATE_DATA LIKE LINE OF GT_ITEM_UPDATE_DATA.
